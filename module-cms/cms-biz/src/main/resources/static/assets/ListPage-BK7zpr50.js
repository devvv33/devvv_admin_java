import{H as I,d as xe,r as b,p as U,q as be,I as Je,h as w,v,o as s,w as y,c as T,F as de,y as ye,A as D,l as Te,J as Z,e as Ce,z as ee,f as C,n as J,j as $,K as at,g as lt,E as W,L as nt,_ as ot,a as Ge,b as We,M as Ie,N as $e,s as Xe,t as He,O as it,C as Ue,Q as rt,R as st,B as ut,S as dt,U as P,V as je,G as ct}from"./index-C8i0fY7D.js";import{_ as Le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as Ne}from"./IconDisplay-BcvWcjpY.js";const pt={getEnumOptions(f){return I.post("/cmsApi/sys/selector/listOptionsByEnum",{className:f})}};function ce(f,F,i){if(!f)return i;try{const u=JSON.parse(f);return F in u&&u[F]!==void 0?u[F]:i}catch{return i}}function Oe(f){if(!f)return{};try{return JSON.parse(f)}catch{return{}}}function ne(f,F,i=!1){const u=ce(f,F,i);return typeof u=="boolean"?u:typeof u=="string"?u==="true":i}function qe(f,F,i=0){const u=ce(f,F,i),k=Number(u);return isNaN(k)?i:k}function R(f,F,i=""){const u=ce(f,F,i);return u!=null?String(u):i}const mt={class:"el-upload__tip"},ft={key:10,class:"file-download-wrapper"},yt=["href","download"],vt=xe({__name:"DynamicForm",props:{fields:{},modelValue:{},inline:{type:Boolean,default:!1},labelWidth:{default:"90px"},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","initialized","submit"],setup(f,{expose:F,emit:i}){const u=f,k=i,r=b({}),L=b(!1),S=b({}),G=U(()=>{const a={};return u.fields.forEach(n=>{if(n.required){let d=`请输入${n.fieldLabel}`,x=["input","change","blur"];a[n.fieldKey]=[{required:!0,message:d,trigger:x}]}}),a}),M=b({}),te=async a=>{for(const n of a)if(n.inputType==="select"){const d=Oe(n.extra);if(d.localOptions){M.value[n.fieldKey]=d.localOptions||[];continue}if(d.enumOptions){M.value[n.fieldKey]=await pt.getEnumOptions(d.enumOptions);continue}if(d.queryUrl){M.value[n.fieldKey]=await I.post(d.queryUrl,{});continue}M.value[n.fieldKey]||(M.value[n.fieldKey]=[])}},j=a=>M.value[a.fieldKey]||[],h=b({}),g=async a=>{for(const n of a)if(n.inputType==="treeSelect"){const d=Oe(n.extra);if(d.queryUrl){h.value[n.fieldKey]=await I.post(d.queryUrl,{});continue}}},N=a=>h.value[a.fieldKey]||[],ae=a=>ne(a.extra,"checkStrictly",!1),z=a=>ne(a.extra,"showCheckbox",!0),ve=a=>ne(a.extra,"collapseTags",!1),oe=a=>{const n=Oe(a.extra),d={value:"value",label:"label",children:"children",disabled:"disabled"};return n.props?{...d,...n.props}:d};be(()=>u.fields,async a=>{if(!L.value){const n={};Object.assign(n,u.modelValue),a.forEach(d=>{if(!(d.fieldKey in n)){const x=ce(d.extra,"defaultValue");x!==void 0&&(n[d.fieldKey]=x)}}),r.value=n,L.value=!0,k("update:modelValue",{...r.value}),await Je(),k("initialized")}await te(a),await g(a)},{immediate:!0}),be(()=>u.modelValue,a=>{JSON.stringify(a)!==JSON.stringify(r.value)&&(r.value={...a})},{deep:!0}),be(r,a=>{k("update:modelValue",{...a})},{deep:!0});const O=a=>R(a.extra,"placeholder",`请输入${a.fieldLabel}`),_=a=>ne(a.extra,"disabled",!1),E=a=>ne(a.extra,"readonly",!1),X=a=>ne(a.extra,"multiple",!1),K=a=>u.inline?a.inputType==="dateRange"?{width:"240px"}:{width:"200px"}:{width:"100%"},ge=()=>{k("submit")},ke=a=>R(a.extra,"accept",""),A=a=>{const n=ce(a.extra,"limit");return n!==void 0?Number(n):X(a)?9999:1},V=a=>{const n=ce(a.extra,"maxSize");return n!==void 0?Number(n):10},pe=a=>{const n=ke(a),d=V(a),x=A(a),Y=X(a);let B="";return n&&(B+=`支持 ${n} 格式`),d&&(B+=(B?"，":"")+`单个文件不超过 ${d}MB`),Y&&x&&x!==9999&&(B+=(B?"，":"")+`最多上传 ${x} 个文件`),B||"请选择要上传的文件"},he=(a,n)=>{S.value[a]=n,r.value[a]=n.length>0?n:void 0},ie=(a,n)=>{S.value[a]=n,r.value[a]=n.length>0?n:void 0},_e=()=>{W.warning("文件数量超出限制")},re=(a,n)=>{const d=V(a),x=n.size/1024/1024;return d&&x>d?(W.error(`文件大小不能超过 ${d}MB`),!1):!0},H=()=>u.fields.some(a=>a.inputType==="upload"),Me=()=>{const a=new FormData;return u.fields.forEach(n=>{const d=n.fieldKey,x=r.value[d];n.inputType==="upload"?(S.value[d]||[]).forEach(B=>{if(B.raw){const le=X(n)?`${d}[]`:d;a.append(le,B.raw)}}):x!=null&&(Array.isArray(x)?x.forEach(Y=>a.append(d,String(Y))):typeof x=="object"?a.append(d,JSON.stringify(x)):a.append(d,String(x)))}),a},Q=b();return F({formRef:Q,validate:()=>{var a;return(a=Q.value)==null?void 0:a.validate()},validateField:a=>{var n;return(n=Q.value)==null?void 0:n.validateField(a)},resetFields:()=>{var a;return(a=Q.value)==null?void 0:a.resetFields()},clearValidate:()=>{var a;return(a=Q.value)==null?void 0:a.clearValidate()},hasFileFields:H,getFormData:Me}),(a,n)=>{const d=w("el-input"),x=w("el-input-number"),Y=w("el-select"),B=w("el-tree-select"),le=w("el-date-picker"),Ke=w("el-switch"),Se=w("el-button"),we=w("el-upload"),t=w("el-icon"),l=w("el-form-item"),c=w("el-form");return s(),v(c,{ref_key:"formRef",ref:Q,model:r.value,rules:G.value,inline:f.inline,"label-width":f.labelWidth,disabled:f.disabled,onSubmit:n[0]||(n[0]=lt(()=>{},["prevent"]))},{default:y(()=>[(s(!0),T(de,null,ye(f.fields,e=>(s(),v(l,{key:e.fieldKey,label:e.fieldLabel,prop:e.fieldKey},{default:y(()=>[e.inputType==="input"?(s(),v(d,{key:0,modelValue:r.value[e.fieldKey],"onUpdate:modelValue":p=>r.value[e.fieldKey]=p,placeholder:O(e),disabled:_(e),readonly:E(e),style:Z(K(e)),clearable:"",onKeyup:Te(ge,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled","readonly","style"])):e.inputType==="textarea"?(s(),v(d,{key:1,modelValue:r.value[e.fieldKey],"onUpdate:modelValue":p=>r.value[e.fieldKey]=p,type:"textarea",rows:4,placeholder:O(e),disabled:_(e),readonly:E(e),style:Z(K(e)),onKeyup:Te(ge,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled","readonly","style"])):e.inputType==="number"?(s(),v(x,{key:2,modelValue:r.value[e.fieldKey],"onUpdate:modelValue":p=>r.value[e.fieldKey]=p,placeholder:O(e),disabled:_(e),readonly:E(e),align:"left",style:Z(K(e)),onKeyup:Te(ge,["enter"])},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled","readonly","style"])):e.inputType==="select"?(s(),v(Y,{key:3,modelValue:r.value[e.fieldKey],"onUpdate:modelValue":p=>r.value[e.fieldKey]=p,options:j(e),props:oe(e),placeholder:O(e),disabled:_(e),readonly:E(e),multiple:X(e),style:Z(K(e)),clearable:""},null,8,["modelValue","onUpdate:modelValue","options","props","placeholder","disabled","readonly","multiple","style"])):e.inputType==="treeSelect"?(s(),v(B,{key:4,modelValue:r.value[e.fieldKey],"onUpdate:modelValue":p=>r.value[e.fieldKey]=p,data:N(e),props:oe(e),"node-key":oe(e).value,placeholder:O(e),disabled:_(e),readonly:E(e),multiple:X(e),"check-strictly":ae(e),"show-checkbox":z(e),"collapse-tags":ve(e),"collapse-tags-tooltip":ve(e),"render-after-expand":!1,style:Z(K(e)),clearable:""},null,8,["modelValue","onUpdate:modelValue","data","props","node-key","placeholder","disabled","readonly","multiple","check-strictly","show-checkbox","collapse-tags","collapse-tags-tooltip","style"])):e.inputType==="date"?(s(),v(le,{key:5,modelValue:r.value[e.fieldKey],"onUpdate:modelValue":p=>r.value[e.fieldKey]=p,type:"date",placeholder:O(e),disabled:_(e),readonly:E(e),style:Z(K(e))},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled","readonly","style"])):e.inputType==="datetime"?(s(),v(le,{key:6,modelValue:r.value[e.fieldKey],"onUpdate:modelValue":p=>r.value[e.fieldKey]=p,type:"datetime",placeholder:O(e),disabled:_(e),readonly:E(e),style:Z(K(e))},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled","readonly","style"])):e.inputType==="dateRange"?(s(),v(le,{key:7,modelValue:r.value[e.fieldKey],"onUpdate:modelValue":p=>r.value[e.fieldKey]=p,type:"daterange",placeholder:O(e),disabled:_(e),readonly:E(e),style:Z(K(e))},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled","readonly","style"])):e.inputType==="switch"?(s(),v(Ke,{key:8,modelValue:r.value[e.fieldKey],"onUpdate:modelValue":p=>r.value[e.fieldKey]=p,disabled:_(e),readonly:E(e)},null,8,["modelValue","onUpdate:modelValue","disabled","readonly"])):e.inputType==="upload"?(s(),v(we,{key:9,"file-list":S.value[e.fieldKey],"onUpdate:fileList":p=>S.value[e.fieldKey]=p,accept:ke(e),limit:A(e),multiple:X(e),disabled:_(e),"auto-upload":!1,"on-change":(p,q)=>he(e.fieldKey,q),"on-remove":(p,q)=>ie(e.fieldKey,q),"on-exceed":_e,"before-upload":p=>re(e,p),style:Z(K(e))},{trigger:y(()=>[C(Se,{type:"primary",disabled:_(e)},{default:y(()=>[...n[1]||(n[1]=[J(" 选择文件 ",-1)])]),_:1},8,["disabled"])]),tip:y(()=>[Ce("div",mt,ee(pe(e)),1)]),_:2},1032,["file-list","onUpdate:fileList","accept","limit","multiple","disabled","on-change","on-remove","before-upload","style"])):e.inputType==="download"?(s(),T("div",ft,[Ce("a",{href:$(R)(e.extra,"fileUrl",""),download:$(R)(e.extra,"fileName","下载文件"),target:"_blank",class:"file-download-link"},[C(t,null,{default:y(()=>[C($(at))]),_:1}),Ce("span",null,ee($(R)(e.extra,"fileName","下载文件")),1)],8,yt)])):D("",!0)]),_:2},1032,["label","prop"]))),128))]),_:1},8,["model","rules","inline","label-width","disabled"])}}}),Qe=Le(vt,[["__scopeId","data-v-cee9eb67"]]),gt=xe({__name:"ModalForm",props:{modelValue:{type:Boolean},title:{},fields:{},formData:{},width:{default:"600px"},loading:{type:Boolean}},emits:["update:modelValue","submit"],setup(f,{emit:F}){const i=f,u=F,k=b(),r=U({get:()=>i.modelValue,set:h=>u("update:modelValue",h)}),L=U(()=>typeof window>"u"?i.width:window.innerWidth<=768?"95%":i.width),S=b({});be(()=>i.formData,h=>{S.value={...h}},{immediate:!0,deep:!0});const G=U(()=>i.fields.map(h=>{if(h.required&&h.extra)try{const g=JSON.parse(h.extra);if(!g.rules)return g.rules=[{required:!0,message:`请输入${h.fieldLabel}`,trigger:["input","change","blur"]}],{...h,extra:JSON.stringify(g)}}catch{}return h})),M=async()=>{var g;const h=(g=k.value)==null?void 0:g.formRef;if(!h){const N=te();u("submit",N);return}await h.validate(N=>{if(N){const ae=te();u("submit",ae)}})},te=()=>{var g,N;return((N=(g=k.value)==null?void 0:g.hasFileFields)==null?void 0:N.call(g))?k.value.getFormData():{...S.value}},j=()=>{var g;r.value=!1;const h=(g=k.value)==null?void 0:g.formRef;h==null||h.resetFields()};return(h,g)=>{const N=w("el-button"),ae=w("el-dialog");return s(),v(ae,{modelValue:r.value,"onUpdate:modelValue":g[1]||(g[1]=z=>r.value=z),title:f.title,width:L.value,class:"modal-form",onClose:j},{footer:y(()=>[C(N,{onClick:j},{default:y(()=>[...g[2]||(g[2]=[J("取消",-1)])]),_:1}),C(N,{type:"primary",onClick:M,loading:f.loading},{default:y(()=>[...g[3]||(g[3]=[J("确定",-1)])]),_:1},8,["loading"])]),default:y(()=>[C(Qe,{ref_key:"dynamicFormRef",ref:k,modelValue:S.value,"onUpdate:modelValue":g[0]||(g[0]=z=>S.value=z),fields:G.value,"label-width":"100px"},null,8,["modelValue","fields"])]),_:1},8,["modelValue","title","width"])}}}),ht=xe({__name:"ModalList",props:{modelValue:{type:Boolean},title:{},width:{default:"80%"},menuConfig:{},childrenMenu:{default:()=>[]},rowData:{default:()=>({})}},emits:["update:modelValue"],setup(f,{emit:F}){const i=nt(()=>ot(()=>Promise.resolve().then(()=>Vt),void 0)),u=f,k=F,r=U({get:()=>u.modelValue,set:G=>k("update:modelValue",G)}),L=U(()=>typeof window>"u"?u.width:window.innerWidth<=768?"95%":u.width),S=()=>{r.value=!1};return(G,M)=>{const te=w("el-dialog");return s(),v(te,{modelValue:r.value,"onUpdate:modelValue":M[0]||(M[0]=j=>r.value=j),title:f.title,width:L.value,"destroy-on-close":"",class:"modal-list",onClose:S},{default:y(()=>[C($(i),{"menu-config":f.menuConfig,"children-menu":f.childrenMenu,"initial-params":f.rowData},null,8,["menu-config","children-menu","initial-params"])]),_:1},8,["modelValue","title","width"])}}}),_t={class:"search-buttons"},wt=["href"],bt={key:3},xt={key:1,class:"pagination-container"},kt={key:2,class:"footer-buttons"},St=xe({__name:"ListContent",props:{menuConfig:{},childrenMenu:{},initialParams:{}},setup(f){const F=Ge(),i=f,u=b(!1),k=()=>{u.value=window.innerWidth<=768},r=b(!1),L=b(),S=b(1e3),G=U(()=>{var t;return R((t=i.menuConfig)==null?void 0:t.extra,"rowKey","")}),M=U(()=>{var t;return ne((t=i.menuConfig)==null?void 0:t.extra,"defaultExpandAll",!1)}),te=U(()=>{var t;return((t=i.menuConfig)==null?void 0:t.columnFieldList)||[]}),j=U(()=>{var t;return((t=i.menuConfig)==null?void 0:t.searchFieldList)||[]}),h=U(()=>{var t;return ne((t=i.menuConfig)==null?void 0:t.extra,"pagination",!0)}),g=U(()=>{var t;return qe((t=i.menuConfig)==null?void 0:t.extra,"pageSize",10)}),N=U(()=>{var t;return((t=i.menuConfig)==null?void 0:t.apiUrl)||""}),ae=b();let z=We({});const ve=()=>{i.initialParams&&Object.assign(z,i.initialParams)},oe=b([]),O=b(!1),_=We({pageNum:1,pageSize:g.value,total:0}),E=U(()=>{var t;return((t=i.childrenMenu)==null?void 0:t.filter(l=>l.menuType==Ie.BUTTON&&l.buttonPosition===$e.ROW))||[]}),X=U(()=>{var t;return((t=i.childrenMenu)==null?void 0:t.filter(l=>l.menuType==Ie.BUTTON&&l.buttonPosition===$e.FOOTER))||[]}),K=U(()=>{var fe;const t=E.value,l=t.length;if(l===0)return{columnWidth:0,visibleButtons:[],hiddenButtons:[]};const c=u.value?1:qe((fe=i.menuConfig)==null?void 0:fe.extra,"maxColumnButtons",3),e=l>c?c-1:l,p=42,q=Math.min(l,c);return{columnWidth:Math.max(q*p,50),visibleButtons:t.slice(0,e),hiddenButtons:t.slice(e)}}),ge=t=>{if(t){if(typeof t=="string"&&t.includes("%")){const l=parseFloat(t),c=Math.max(800,S.value-K.value.columnWidth),e=Math.floor(c*l/100);return Math.max(20,e)}return t}},ke=()=>{Je(()=>{var t;if((t=L.value)!=null&&t.$el){const l=L.value.$el.clientWidth;l>0&&(S.value=l)}})},A=b(!1),V=b(null),pe=b({}),he=b(!1),ie=b(!1),_e=b([]),re=async()=>{if(i.menuConfig){if(!N.value){W.warning("未配置查询接口");return}O.value=!0;try{const t={...i.initialParams||{},...z};h.value&&(t.pageNum=_.pageNum,t.pageSize=_.pageSize);const l=await I.post(N.value,{...t});h.value?(oe.value=l.list||[],_.total=Number(l.total)||0):oe.value=l}catch(t){W.error(t.message||"加载数据失败")}finally{O.value=!1}}},H=(t,l,c)=>{if(!c)return t;try{return new Function("value","row",c)(t,l)}catch{return t}},Me=(t,l)=>{const c=String(t||""),e=ce(l.extra,"tagMap",{});if(e&&typeof e=="object"&&Object.keys(e).length>0){if(e[c])return e[c];if(e.default)return e.default}return{正常:"success",启用:"success",成功:"success",已通过:"success",已完成:"success",是:"success",禁用:"danger",异常:"danger",失败:"danger",已拒绝:"danger",错误:"danger",否:"danger",待审核:"warning",处理中:"warning",进行中:"warning",警告:"warning",草稿:"info",未开始:"info",已取消:"info"}[c]||""},Q=t=>{let l=R(t.extra,"buttonType","");return!l&&t.menuName.includes("删除")?"danger":!l&&t.menuName.includes("添加")||!l&&t.menuName.includes("新增")||!l&&t.menuName.includes("编辑")||!l&&t.menuName.includes("修改")?"primary":l||"default"},a=()=>{_.pageNum=1,re()},n=()=>{var l;const t=(l=ae.value)==null?void 0:l.formRef;t==null||t.resetFields(),a()},d=t=>{_.pageSize=t,_.pageNum=1,re()},x=t=>{_.pageNum=t,re()},Y=async(t,l)=>{V.value=t;let c={...l};if(V.value.beforeShowScript)try{const e=Object.getPrototypeOf(async function(){}).constructor;c=await new e("row","request",V.value.beforeShowScript)(c,I)}catch(e){console.error("执行展示前脚本失败:",e)}if(pe.value=c,t.buttonAction===P.MODAL_FORM)A.value=!0;else if(t.buttonAction===P.MODAL_LIST)_e.value=F.listMenuByParentId(t.id)||[],ie.value=!0;else if(t.buttonAction===P.CONFIRM){const e=R(t.extra,"message",`确定要${t.menuName}吗？`);je.confirm(e,"提示",{type:"warning"}).then(()=>{Se(t,l)}).catch(()=>{})}else t.buttonAction===P.PAGE&&t.apiUrl&&window.open(t.apiUrl,"_blank")},B=t=>{if(V.value=t,pe.value={},t.buttonAction===P.MODAL_FORM)A.value=!0;else if(t.buttonAction===P.MODAL_LIST)_e.value=F.listMenuByParentId(t.id)||[],ie.value=!0;else if(t.buttonAction===P.CONFIRM){const l=R(t.extra,"message",`确定要${t.menuName}吗？`);je.confirm(l,"提示",{type:"warning"}).then(()=>{Se(t,{})}).catch(()=>{})}else t.buttonAction===P.EXPORT?t.formFieldList&&t.formFieldList.length>0?A.value=!0:le(t):t.buttonAction===P.DOWNLOAD?t.apiUrl&&window.open(t.apiUrl,"_blank"):t.buttonAction===P.PAGE&&t.apiUrl&&window.open(t.apiUrl,"_blank")},le=async(t,l)=>{var c;if(t.apiUrl){O.value=!0;try{const e={...i.initialParams||{},...z,...l||{}},p=await I.post(t.apiUrl,e,{responseType:"blob"});if(p.data.type==="application/json"){const ue=await p.data.text();try{const Fe=JSON.parse(ue);W.error(Fe.msg||"导出失败");return}catch{}}const q=(c=p.headers)==null?void 0:c["content-disposition"];let me="导出文件.xlsx";if(q){const ue=q.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/i);ue&&ue[1]&&(me=decodeURIComponent(ue[1].replace(/['"]/g,"")))}const fe=new Blob([p.data]),Ve=window.URL.createObjectURL(fe),se=document.createElement("a");se.href=Ve,se.download=me,document.body.appendChild(se),se.click(),document.body.removeChild(se),window.URL.revokeObjectURL(Ve),W.success("导出成功")}catch(e){console.error("导出失败:",e),W.error("导出失败")}finally{O.value=!1}}},Ke=async t=>{if(!V.value)return;if(V.value.buttonAction===P.EXPORT){A.value=!1;const c=t instanceof FormData?Object.fromEntries(t.entries()):t;await le(V.value,c);return}let l=t;he.value=!0;try{if(V.value.beforeSubmitScript&&!(t instanceof FormData))try{const c=Object.getPrototypeOf(async function(){}).constructor;l=await new c("formData","request",V.value.beforeSubmitScript)(t,I)}catch(c){console.error("执行提交前脚本失败:",c)}V.value.apiUrl&&(l instanceof FormData?await I.upload(V.value.apiUrl,l):await I.post(V.value.apiUrl,l),W.success("操作成功"),A.value=!1,re())}finally{he.value=!1}},Se=async(t,l)=>{let c=l||{};if(t.beforeSubmitScript)try{const e=Object.getPrototypeOf(async function(){}).constructor;c=await new e("formData","request",t.beforeSubmitScript)(c,I)}catch(e){console.error("执行提交前脚本失败:",e),W.error("执行提交前脚本失败");return}t.apiUrl?(await I.post(t.apiUrl,c),W.success("操作成功"),re()):(console.error("未配置提交接口",t),W.error("操作失败,请联系管理员"))},we=()=>{ke(),k()};return Xe(async()=>{ve(),i.menuConfig&&(!i.menuConfig.searchFieldList||i.menuConfig.searchFieldList.length==0)&&a(),we(),window.addEventListener("resize",we)}),He(()=>{window.removeEventListener("resize",we)}),be(()=>i.menuConfig,t=>{t&&(_.pageNum=1,_.pageSize=g.value,ve(),(!t.searchFieldList||t.searchFieldList.length==0)&&a())},{deep:!0}),(t,l)=>{var ze,Be,De,Ee,Re;const c=w("el-button"),e=w("el-icon"),p=w("el-tag"),q=w("el-image"),me=w("el-table-column"),fe=w("el-tooltip"),Ve=w("el-dropdown-item"),se=w("el-dropdown-menu"),ue=w("el-dropdown"),Fe=w("el-table"),Ze=w("el-pagination"),et=it("loading");return s(),T("div",{class:Ue(["list-content",{mobile:u.value}])},[j.value.length>0?(s(),T("div",{key:0,class:Ue(["search-form",{"search-collapsed":u.value&&!r.value}])},[C(Qe,{ref_key:"searchFormRef",ref:ae,modelValue:$(z),"onUpdate:modelValue":l[0]||(l[0]=o=>st(z)?z.value=o:z=o),fields:j.value,inline:!u.value,"label-width":u.value?"90px":"auto",onInitialized:a,onSubmit:a},null,8,["modelValue","fields","inline","label-width"]),Ce("div",_t,[C(c,{type:"primary",onClick:a},{default:y(()=>[...l[6]||(l[6]=[J("查询",-1)])]),_:1}),C(c,{onClick:n},{default:y(()=>[...l[7]||(l[7]=[J("重置",-1)])]),_:1}),u.value&&j.value.length>0?(s(),v(c,{key:0,onClick:l[1]||(l[1]=o=>r.value=!r.value),link:""},{default:y(()=>[J(ee(r.value?"收起":"展开")+" ",1),C(e,{class:Ue({"rotate-180":r.value})},{default:y(()=>[C($(ut))]),_:1},8,["class"])]),_:1})):D("",!0)])],2)):D("",!0),rt((s(),v(Fe,{ref_key:"tableRef",ref:L,data:oe.value,border:"",stripe:"",height:"100%",style:{width:"100%"},"row-key":G.value,"default-expand-all":M.value,"show-overflow-tooltip":""},{default:y(()=>[(s(!0),T(de,null,ye(te.value,o=>(s(),v(me,{key:o.fieldKey,prop:o.fieldKey,label:o.fieldLabel,width:ge(o.width)},{default:y(({row:m})=>[o.showType==="TAG"?(s(),v(p,{key:0,effect:$(R)(o.extra,"tagEffect","light"),type:Me(H(m[o.fieldKey],m,o.formatScript),o)},{default:y(()=>[J(ee(H(m[o.fieldKey],m,o.formatScript)),1)]),_:2},1032,["effect","type"])):o.showType==="IMAGE"?(s(),T(de,{key:1},[H(m[o.fieldKey],m,o.formatScript)?(s(!0),T(de,{key:0},ye(String(H(m[o.fieldKey],m,o.formatScript)).split(","),(Ae,Pe)=>(s(),v(q,{key:Pe,src:Ae.trim(),style:{width:"40px",height:"40px","margin-right":"4px"},fit:"contain",loading:"lazy","preview-src-list":String(H(m[o.fieldKey],m,o.formatScript)).split(",").map(tt=>tt.trim()),"initial-index":Pe,scale:.8,"hide-on-click-modal":!0,"show-progress":!0,"preview-teleported":!0},null,8,["src","preview-src-list","initial-index"]))),128)):D("",!0)],64)):o.showType==="LINK"?(s(),T("a",{key:2,href:m[o.fieldKey],target:"_blank"},ee(H(m[o.fieldKey],m,o.formatScript)),9,wt)):(s(),T("span",bt,ee(H(m[o.fieldKey],m,o.formatScript)),1))]),_:2},1032,["prop","label","width"]))),128)),E.value.length>0?(s(),v(me,{key:0,label:"操作",width:K.value.columnWidth,fixed:"right","class-name":"operation-column"},{default:y(({row:o})=>[(s(!0),T(de,null,ye(K.value.visibleButtons,m=>(s(),v(fe,{key:m.id,effect:"dark",content:m.menuName,placement:"top"},{default:y(()=>[C(c,{type:Q(m),link:"",size:"large",onClick:Ae=>Y(m,o)},{default:y(()=>[m.icon?(s(),v(Ne,{key:0,icon:m.icon,size:16},null,8,["icon"])):D("",!0),J(" "+ee(m.icon?"":m.menuName),1)]),_:2},1032,["type","onClick"])]),_:2},1032,["content"]))),128)),K.value.hiddenButtons.length>0?(s(),v(ue,{key:0,trigger:"click",onCommand:m=>Y(m,o)},{dropdown:y(()=>[C(se,null,{default:y(()=>[(s(!0),T(de,null,ye(K.value.hiddenButtons,m=>(s(),v(Ve,{key:m.id,command:m},{default:y(()=>[m.icon?(s(),v(Ne,{key:0,icon:m.icon,size:16,style:{"margin-right":"5px"}},null,8,["icon"])):D("",!0),J(" "+ee(m.menuName),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:y(()=>[C(c,{type:"primary",link:""},{default:y(()=>[C(e,null,{default:y(()=>[C($(dt))]),_:1})]),_:1})]),_:1},8,["onCommand"])):D("",!0)]),_:1},8,["width"])):D("",!0)]),_:1},8,["data","row-key","default-expand-all"])),[[et,O.value]]),h.value?(s(),T("div",xt,[C(Ze,{"current-page":_.pageNum,"onUpdate:currentPage":l[2]||(l[2]=o=>_.pageNum=o),"page-size":_.pageSize,"onUpdate:pageSize":l[3]||(l[3]=o=>_.pageSize=o),"page-sizes":[10,20,50,100],total:_.total,size:u.value?"small":"default",layout:"total, prev, pager, next",onSizeChange:d,onCurrentChange:x},null,8,["current-page","page-size","total","size"])])):D("",!0),X.value.length>0?(s(),T("div",kt,[(s(!0),T(de,null,ye(X.value,o=>(s(),v(c,{key:o.id,type:Q(o),onClick:m=>B(o)},{default:y(()=>[o.icon?(s(),v(Ne,{key:0,icon:o.icon,size:16,style:{"margin-right":"5px"}},null,8,["icon"])):D("",!0),J(" "+ee(o.menuName),1)]),_:2},1032,["type","onClick"]))),128))])):D("",!0),A.value?(s(),v(gt,{key:3,modelValue:A.value,"onUpdate:modelValue":l[4]||(l[4]=o=>A.value=o),width:$(R)((ze=V.value)==null?void 0:ze.extra,"modalWidth","600px"),title:((Be=V.value)==null?void 0:Be.menuName)||"",fields:((De=V.value)==null?void 0:De.formFieldList)||[],"form-data":pe.value,loading:he.value,onSubmit:Ke},null,8,["modelValue","width","title","fields","form-data","loading"])):D("",!0),ie.value?(s(),v(ht,{key:4,modelValue:ie.value,"onUpdate:modelValue":l[5]||(l[5]=o=>ie.value=o),title:((Ee=V.value)==null?void 0:Ee.menuName)||"",width:$(R)((Re=V.value)==null?void 0:Re.extra,"modalWidth","80%"),"menu-config":V.value,"children-menu":_e.value,"row-data":pe.value},null,8,["modelValue","title","width","menu-config","children-menu","row-data"])):D("",!0)],2)}}}),Ye=Le(St,[["__scopeId","data-v-2e1bfdf6"]]),Vt=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"})),Ft=xe({__name:"ListPage",setup(f){const F=ct(),i=Ge(),u=b(!1),k=()=>{u.value=window.innerWidth<=768},r=b(null),L=b(null);return Xe(async()=>{const S=F.name;S&&typeof S=="string"&&(r.value=i.getMenuById(S)||null,L.value=i.listMenuByParentId(S)),k(),window.addEventListener("resize",k)}),He(()=>{window.removeEventListener("resize",k)}),(S,G)=>{const M=w("el-card");return s(),T("div",{class:Ue(["list-page-container",{mobile:u.value}])},[C(M,null,{default:y(()=>[C(Ye,{"menu-config":r.value,"children-menu":L.value},null,8,["menu-config","children-menu"])]),_:1})],2)}}}),Kt=Le(Ft,[["__scopeId","data-v-44851431"]]);export{Kt as default};
