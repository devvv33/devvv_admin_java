const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C8i0fY7D.js","assets/index-DUwaITfz.css"])))=>i.map(i=>d[i]);
import{d as de,u as ce,a as _e,r as N,p as S,q as me,s as pe,_ as B,t as fe,v as i,w as n,h as p,f as d,e as a,j as v,x as ye,c as m,y as T,F as f,n as A,z as c,A as r,B as ve,C as he,T as ke,D as we,G as xe,i as Te,P as j,M as q,o as e}from"./index-C8i0fY7D.js";import{I as x}from"./IconDisplay-BcvWcjpY.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ge={class:"header-left"},Ee={class:"header-right"},Me={class:"user-info"},Pe={class:"user-details"},be={class:"username"},Re={key:0,class:"user-role"},Ce={class:"dropdown-user-header"},ze={class:"dropdown-user-info"},De={class:"dropdown-username"},Ne={class:"dropdown-account"},Le={class:"dropdown-id"},Ae={class:"dropdown-roles"},Oe={class:"role-tags"},Se=de({__name:"MainLayout",setup(Be){const V=xe(),g=Te(),h=ce(),w=_e(),M=N(!1),O=()=>{M.value=window.innerWidth<=768,M.value&&(P.value=!1)},P=N(!1),J=()=>{P.value=!P.value},G=()=>{P.value=!1},U=N(!1),Q=S(()=>M.value?"250px":U.value?"64px":"200px"),E=N(""),Y=N(""),b=S(()=>w.topMenus),X=S(()=>E.value?w.getChildrenMenus(E.value):b.value.length>0?w.getChildrenMenus(b.value[0].id):[]),Z=_=>w.getChildrenMenus(_);me(()=>V.path,_=>{Y.value=_;const l=w.getMenuByPath(_);if(l){let u=l;for(;u;){if(u.menuType===q.MODULE){E.value=u.id;break}if(u.parentId)u=w.getMenuById(u.parentId);else break}}},{immediate:!0});const $=async _=>{E.value=_,w.menuList.length===0&&await w.loadMenus();const l=w.getChildrenMenus(_),u=F(l);if(u!=null&&u.routePath){if(!g.getRoutes().some(y=>y.path===u.routePath)){const{addDynamicRoutes:y}=await B(async()=>{const{addDynamicRoutes:R}=await import("./index-C8i0fY7D.js").then(L=>L.ad);return{addDynamicRoutes:R}},__vite__mapDeps([0,1]));await y()}g.push(u.routePath).catch(y=>{console.error("路由跳转失败:",y),g.push("/home")})}else g.push("/home")},ee=async _=>{M.value&&G();const l=w.getMenuByPath(_);if((l==null?void 0:l.pageType)===j.OUTER_LINK&&l.routePath){window.open(l.routePath,"_blank");return}if(!g.getRoutes().some(I=>I.path===_)&&_.startsWith("/")){const{addDynamicRoutes:I}=await B(async()=>{const{addDynamicRoutes:y}=await import("./index-C8i0fY7D.js").then(R=>R.ad);return{addDynamicRoutes:y}},__vite__mapDeps([0,1]));await I()}g.push(_).catch(I=>{console.error("路由跳转失败:",I),g.push("/home")})},F=_=>{for(const l of _){if(l.menuType===q.PAGE&&l.pageType!==j.OUTER_LINK)return l;if(l.children&&l.children.length>0){const u=F(l.children);if(u)return u}}return null},ne=_=>{_==="logout"&&h.logout()};return pe(async()=>{w.menuList.length===0&&await w.loadMenus();const{addDynamicRoutes:_}=await B(async()=>{const{addDynamicRoutes:l}=await import("./index-C8i0fY7D.js").then(u=>u.ad);return{addDynamicRoutes:l}},__vite__mapDeps([0,1]));await _(),b.value.length>0&&!E.value&&(E.value=b.value[0].id),O(),window.addEventListener("resize",O)}),fe(()=>{window.removeEventListener("resize",O)}),(_,l)=>{const u=p("el-icon"),I=p("el-button"),y=p("el-menu-item"),R=p("el-menu"),L=p("el-avatar"),W=p("el-divider"),te=p("el-tag"),oe=p("el-dropdown-item"),ae=p("el-dropdown-menu"),se=p("el-dropdown"),ie=p("el-header"),C=p("el-sub-menu"),le=p("el-aside"),ue=p("router-view"),re=p("el-main"),H=p("el-container");return e(),i(H,{class:"main-layout"},{default:n(()=>[d(ie,{class:"header"},{default:n(()=>[a("div",ge,[d(I,{class:"mobile-menu-toggle",text:"",onClick:J},{default:n(()=>[d(u,{size:24},{default:n(()=>[d(v(ye))]),_:1})]),_:1}),l[0]||(l[0]=a("div",{class:"logo"},[a("span",{class:"logo-text"},"DevvvAdmin")],-1)),d(R,{mode:"horizontal","default-active":E.value,class:"top-menu",onSelect:$},{default:n(()=>[(e(!0),m(f,null,T(b.value,t=>(e(),i(y,{key:t.id,index:t.id},{default:n(()=>[t.icon?(e(),i(x,{key:0,icon:t.icon,size:16},null,8,["icon"])):r("",!0),a("span",null,c(t.menuName),1)]),_:2},1032,["index"]))),128))]),_:1},8,["default-active"])]),a("div",Ee,[d(se,{onCommand:ne,"popper-class":"user-dropdown-popper",placement:"bottom-start"},{dropdown:n(()=>[d(ae,{class:"user-dropdown-menu",style:{padding:"0"}},{default:n(()=>{var t,o,s,k,z;return[a("div",Ce,[d(L,{size:40,src:(t=v(h).adminInfo)==null?void 0:t.avatar},{default:n(()=>{var D,K;return[A(c(((K=(D=v(h).adminInfo)==null?void 0:D.nickname)==null?void 0:K[0])||"U"),1)]}),_:1},8,["src"]),a("div",ze,[a("div",De,c(((o=v(h).adminInfo)==null?void 0:o.nickname)||"用户"),1),a("div",Ne,c((s=v(h).adminInfo)==null?void 0:s.username),1),a("div",Le,"ID: "+c((k=v(h).adminInfo)==null?void 0:k.adminId),1)])]),d(W,{style:{margin:"2px 0"}}),a("div",Ae,[l[1]||(l[1]=a("div",{class:"dropdown-roles-title"},"角色权限",-1)),a("div",Oe,[(e(!0),m(f,null,T((z=v(h).adminInfo)==null?void 0:z.roleList,D=>(e(),i(te,{key:D.id,size:"small",effect:"plain",type:"info"},{default:n(()=>[A(c(D.roleName),1)]),_:2},1024))),128))])]),d(W,{style:{margin:"2px 0"}}),d(oe,{command:"logout",class:"logout-item"},{default:n(()=>[...l[2]||(l[2]=[a("svg",{class:"logout-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4m7 14l5-5-5-5m5 5H9"})],-1),A(" 退出登录 ",-1)])]),_:1})]}),_:1})]),default:n(()=>{var t,o,s;return[a("span",Me,[d(L,{size:32,src:(t=v(h).adminInfo)==null?void 0:t.avatar},{default:n(()=>{var k,z;return[A(c(((z=(k=v(h).adminInfo)==null?void 0:k.nickname)==null?void 0:z[0])||"U"),1)]}),_:1},8,["src"]),a("div",Pe,[a("span",be,c(((o=v(h).adminInfo)==null?void 0:o.nickname)||"用户"),1),(s=v(h).adminInfo)!=null&&s.roleList&&v(h).adminInfo.roleList.length>0?(e(),m("span",Re,c(v(h).adminInfo.roleList[0].roleName),1)):r("",!0)]),d(u,null,{default:n(()=>[d(v(ve))]),_:1})])]}),_:1})])]),_:1}),d(H,{class:"body-container"},{default:n(()=>[P.value?(e(),m("div",{key:0,class:"mobile-menu-mask",onClick:G})):r("",!0),d(le,{width:Q.value,class:he(["sidebar",{"mobile-visible":P.value}])},{default:n(()=>[d(R,{"default-active":Y.value,class:"sidebar-menu",collapse:U.value&&!M.value,onSelect:ee},{default:n(()=>[M.value?(e(!0),m(f,{key:0},T(b.value,t=>(e(),m(f,{key:t.id},[t.menuType==="MODULE"?(e(),i(C,{key:0,index:t.id},{title:n(()=>[t.icon?(e(),i(x,{key:0,icon:t.icon,size:16},null,8,["icon"])):r("",!0),a("span",null,c(t.menuName),1)]),default:n(()=>[(e(!0),m(f,null,T(Z(t.id),o=>(e(),m(f,{key:o.id},[o.menuType==="DIRECTORY"?(e(),i(C,{key:0,index:o.id},{title:n(()=>[o.icon?(e(),i(x,{key:0,icon:o.icon,size:16},null,8,["icon"])):r("",!0),a("span",null,c(o.menuName),1)]),default:n(()=>[(e(!0),m(f,null,T(o.children,s=>(e(),m(f,{key:s.id},[s.menuType==="PAGE"?(e(),i(y,{key:0,index:s.routePath||s.id},{default:n(()=>[s.icon?(e(),i(x,{key:0,icon:s.icon,size:16},null,8,["icon"])):r("",!0),a("span",null,c(s.menuName),1)]),_:2},1032,["index"])):s.menuType==="DIRECTORY"?(e(),i(C,{key:1,index:s.id},{title:n(()=>[s.icon?(e(),i(x,{key:0,icon:s.icon,size:16},null,8,["icon"])):r("",!0),a("span",null,c(s.menuName),1)]),default:n(()=>[(e(!0),m(f,null,T(s.children,k=>(e(),m(f,{key:k.id},[k.menuType==="PAGE"?(e(),i(y,{key:0,index:k.routePath||k.id},{default:n(()=>[k.icon?(e(),i(x,{key:0,icon:k.icon,size:16},null,8,["icon"])):r("",!0),a("span",null,c(k.menuName),1)]),_:2},1032,["index"])):r("",!0)],64))),128))]),_:2},1032,["index"])):r("",!0)],64))),128))]),_:2},1032,["index"])):o.menuType==="PAGE"?(e(),i(y,{key:1,index:o.routePath||o.id},{default:n(()=>[o.icon?(e(),i(x,{key:0,icon:o.icon,size:16},null,8,["icon"])):r("",!0),a("span",null,c(o.menuName),1)]),_:2},1032,["index"])):r("",!0)],64))),128))]),_:2},1032,["index"])):r("",!0)],64))),128)):(e(!0),m(f,{key:1},T(X.value,t=>(e(),m(f,{key:t.id},[t.menuType==="DIRECTORY"?(e(),i(C,{key:0,index:t.id},{title:n(()=>[t.icon?(e(),i(x,{key:0,icon:t.icon,size:16},null,8,["icon"])):r("",!0),a("span",null,c(t.menuName),1)]),default:n(()=>[(e(!0),m(f,null,T(t.children,o=>(e(),m(f,{key:o.id},[o.menuType==="PAGE"?(e(),i(y,{key:0,index:o.routePath||o.id},{default:n(()=>[o.icon?(e(),i(x,{key:0,icon:o.icon,size:16},null,8,["icon"])):r("",!0),a("span",null,c(o.menuName),1)]),_:2},1032,["index"])):o.menuType==="DIRECTORY"?(e(),i(C,{key:1,index:o.id},{title:n(()=>[o.icon?(e(),i(x,{key:0,icon:o.icon,size:16},null,8,["icon"])):r("",!0),a("span",null,c(o.menuName),1)]),default:n(()=>[(e(!0),m(f,null,T(o.children,s=>(e(),m(f,{key:s.id},[s.menuType==="PAGE"?(e(),i(y,{key:0,index:s.routePath||s.id},{default:n(()=>[s.icon?(e(),i(x,{key:0,icon:s.icon,size:16},null,8,["icon"])):r("",!0),a("span",null,c(s.menuName),1)]),_:2},1032,["index"])):r("",!0)],64))),128))]),_:2},1032,["index"])):r("",!0)],64))),128))]),_:2},1032,["index"])):t.menuType==="PAGE"?(e(),i(y,{key:1,index:t.routePath||t.id},{default:n(()=>[t.icon?(e(),i(x,{key:0,icon:t.icon,size:16},null,8,["icon"])):r("",!0),a("span",null,c(t.menuName),1)]),_:2},1032,["index"])):r("",!0)],64))),128))]),_:1},8,["default-active","collapse"])]),_:1},8,["width","class"]),d(re,{class:"main-content"},{default:n(()=>[d(ue,null,{default:n(({Component:t})=>[d(ke,{name:"fade",mode:"out-in"},{default:n(()=>[(e(),i(we(t),{key:v(V).name}))]),_:2},1024)]),_:1})]),_:1})]),_:1})]),_:1})}}}),Ye=Ie(Se,[["__scopeId","data-v-77388148"]]);export{Ye as default};
